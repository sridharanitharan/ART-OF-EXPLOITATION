#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>
#include<fcntl.h>
#include<sys/stat.h>
#include<string.h>
void *err_check_malloc(int size);
void fatel_error(char *msg);
void usage(char *program);
int main(int argc ,char *argv[]){
    char *buffer= (char*)malloc(50*sizeof(char));
    char *datafile = (char*)malloc(100*sizeof(char*));
    int fd;
    if(argc<2){
        usage(argv[0]);
    }
    strcpy(datafile,"hello.txt");
    buffer = argv[1];
    printf("%s\n",buffer);
    strcat(buffer,"\n");
    fd = open(datafile,O_WRONLY|O_CREAT|O_APPEND,S_IRUSR|S_IWUSR);
    if(fd==-1){
        fatel_error("{MAIN} cannot open the file format\n");
    }
    printf("file discripter %d\n",fd);
    if(write(fd,buffer,strlen(buffer)) == -1){
        fatel_error("{MAIN} cannot write note's\n");
    }
    if(close(fd)==-1){
        fatel_error("closing... the file discripter\n");
    }
    printf("note has been saved\n");
    free(buffer);
    free(datafile);
}
void *err_check_malloc(int size){
    void *ptr = malloc(size);
    if(ptr==NULL){
        fprintf(stderr,"Cannot allocated the memory\n");
        exit(EXIT_FAILURE);
    }
    return ptr;
}
void fatel_error(char *msg){
    char message[100]={"Fatel{ERROR{*}}"};
    strncat(message,msg,80);
    printf("%s",message);
}
void usage(char *file){
    printf("Usage %s <enter your notes>",file);
    exit(EXIT_FAILURE);
}